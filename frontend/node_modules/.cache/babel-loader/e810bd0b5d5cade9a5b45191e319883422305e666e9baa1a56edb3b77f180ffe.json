{"ast":null,"code":"var _s = $RefreshSig$();\nimport api from '../utils/api';\nimport { useState, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport useFlashMessage from './useFlashMessage';\nexport default function useAuth() {\n  _s();\n  const {\n    setFlashMessage\n  } = useFlashMessage();\n  const {\n    authenticated,\n    setAuthenticated\n  } = useState(false);\n  const history = useHistory();\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      api.defaults.headers.Authorization = `Bearer ${JSON.parse(token)}`;\n      setAuthenticated(true);\n    }\n  }, []);\n  async function register(user) {\n    let msgText = 'Cadastro realizado com sucesso!';\n    let msgType = 'sucess';\n    try {\n      const data = await api.post('/users/register', user).then(response => {\n        return response.data;\n      });\n      await authUser(data);\n    } catch (error) {\n      msgText = error.response.data.message;\n      msgType = 'error';\n    }\n    setFlashMessage(msgText, msgType);\n  }\n  async function authUser(data) {\n    setAuthenticated(true);\n    localStorage.setItem('token', JSON.stringify(data.token));\n    history.push('/');\n  }\n  return {\n    register\n  };\n}\n_s(useAuth, \"+0QBv60211qFj8sts624EsulZfQ=\", false, function () {\n  return [useFlashMessage, useHistory];\n});","map":{"version":3,"names":["api","useState","useEffect","useHistory","useFlashMessage","useAuth","_s","setFlashMessage","authenticated","setAuthenticated","history","token","localStorage","getItem","defaults","headers","Authorization","JSON","parse","register","user","msgText","msgType","data","post","then","response","authUser","error","message","setItem","stringify","push"],"sources":["C:/Users/luizl/OneDrive/Área de Trabalho/Adota Pet/frontend/src/hooks/useAuth.js"],"sourcesContent":["import api from '../utils/api'\r\n\r\nimport {useState, useEffect} from 'react'\r\nimport {useHistory} from 'react-router-dom'\r\nimport useFlashMessage from './useFlashMessage'\r\n\r\nexport default function useAuth() {\r\n    const { setFlashMessage } = useFlashMessage()\r\n    const{ authenticated, setAuthenticated} = useState(false)\r\n    const history = useHistory()\r\n    \r\n    useEffect(()=>{\r\n\r\n        const token = localStorage.getItem('token')\r\n\r\n        if(token) {\r\n            api.defaults.headers.Authorization = `Bearer ${JSON.parse(token)}`\r\n            setAuthenticated(true)\r\n        }\r\n\r\n    }, [])\r\n\r\n    async function register(user) {\r\n        let msgText = 'Cadastro realizado com sucesso!'\r\n        let msgType = 'sucess'\r\n\r\n        try{\r\n            const data = await api.post('/users/register', user).then((response)=>{\r\n                return response.data\r\n            })\r\n\r\n            await authUser(data)\r\n        } catch(error) {\r\n            msgText = error.response.data.message\r\n            msgType = 'error'\r\n        }\r\n        setFlashMessage(msgText, msgType)\r\n    }\r\n\r\n    async function authUser(data){\r\n        setAuthenticated(true)\r\n\r\n        localStorage.setItem('token', JSON.stringify(data.token))\r\n\r\n        history.push('/')\r\n\r\n    }\r\n\r\n    return { register }\r\n\r\n}"],"mappings":";AAAA,OAAOA,GAAG,MAAM,cAAc;AAE9B,SAAQC,QAAQ,EAAEC,SAAS,QAAO,OAAO;AACzC,SAAQC,UAAU,QAAO,kBAAkB;AAC3C,OAAOC,eAAe,MAAM,mBAAmB;AAE/C,eAAe,SAASC,OAAOA,CAAA,EAAG;EAAAC,EAAA;EAC9B,MAAM;IAAEC;EAAgB,CAAC,GAAGH,eAAe,CAAC,CAAC;EAC7C,MAAK;IAAEI,aAAa;IAAEC;EAAgB,CAAC,GAAGR,QAAQ,CAAC,KAAK,CAAC;EACzD,MAAMS,OAAO,GAAGP,UAAU,CAAC,CAAC;EAE5BD,SAAS,CAAC,MAAI;IAEV,MAAMS,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAE3C,IAAGF,KAAK,EAAE;MACNX,GAAG,CAACc,QAAQ,CAACC,OAAO,CAACC,aAAa,GAAI,UAASC,IAAI,CAACC,KAAK,CAACP,KAAK,CAAE,EAAC;MAClEF,gBAAgB,CAAC,IAAI,CAAC;IAC1B;EAEJ,CAAC,EAAE,EAAE,CAAC;EAEN,eAAeU,QAAQA,CAACC,IAAI,EAAE;IAC1B,IAAIC,OAAO,GAAG,iCAAiC;IAC/C,IAAIC,OAAO,GAAG,QAAQ;IAEtB,IAAG;MACC,MAAMC,IAAI,GAAG,MAAMvB,GAAG,CAACwB,IAAI,CAAC,iBAAiB,EAAEJ,IAAI,CAAC,CAACK,IAAI,CAAEC,QAAQ,IAAG;QAClE,OAAOA,QAAQ,CAACH,IAAI;MACxB,CAAC,CAAC;MAEF,MAAMI,QAAQ,CAACJ,IAAI,CAAC;IACxB,CAAC,CAAC,OAAMK,KAAK,EAAE;MACXP,OAAO,GAAGO,KAAK,CAACF,QAAQ,CAACH,IAAI,CAACM,OAAO;MACrCP,OAAO,GAAG,OAAO;IACrB;IACAf,eAAe,CAACc,OAAO,EAAEC,OAAO,CAAC;EACrC;EAEA,eAAeK,QAAQA,CAACJ,IAAI,EAAC;IACzBd,gBAAgB,CAAC,IAAI,CAAC;IAEtBG,YAAY,CAACkB,OAAO,CAAC,OAAO,EAAEb,IAAI,CAACc,SAAS,CAACR,IAAI,CAACZ,KAAK,CAAC,CAAC;IAEzDD,OAAO,CAACsB,IAAI,CAAC,GAAG,CAAC;EAErB;EAEA,OAAO;IAAEb;EAAS,CAAC;AAEvB;AAACb,EAAA,CA5CuBD,OAAO;EAAA,QACCD,eAAe,EAE3BD,UAAU;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}